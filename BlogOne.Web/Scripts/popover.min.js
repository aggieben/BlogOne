var Popover=function(){function n(t){var r,i,f,e,u;this.firstTime=!0;i=document.createElement("div");i.id=n._getId();i.setAttribute("class","bo-popover");i.style.visibility="hidden";i.innerHTML=(f=t.content)!=null?f:"";document.body.appendChild(i);switch(t.position){case"selection":r=this._getSelectionCoords();console.log(r);i.style.left=""+r.x+"px";i.style.top=""+r.y+"px";i.style.marginTop="-"+Math.floor(10+i.clientHeight)+"px";i.style.marginLeft="-"+Math.floor(i.clientWidth/2)+"px";i.style.visibility="visible"}this.div=i;(e=n._current)!=null&&e.remove();n._current=this;u=this;$(i).on("click keyup",function(n){if(n.keyCode!==27)return!1});$(document).on("click keyup",n._removeTrigger);t.eventing.forEach(function(n){return $("#"+i.id+" "+n.selector).on(n.event,function(t){if(n.filter(t))return u.restoreRange(),u.remove(),n.handler(t)})})}return n._current=null,n._getId=function(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).substr(-4)},n._removeTrigger=function(t){var u,i,r;if(i=n._current,i!=null)if(i.firstTime){if(i.firstTime=!1,u=document.querySelector('*[autofocus="true"]'),i.contains(u))return u.focus()}else if((r=t.which)!==16&&r!==17&&r!==18&&r!==91)return i.remove()},n.prototype.remove=function(){return this.div.parentNode.removeChild(this.div),n._current=null,$(document).off("click keyup",n._removeTrigger)},n.prototype.contains=function(n){return this.div.contains(n)},n.prototype.restoreRange=function(){var n;return n=window.getSelection(),n.removeAllRanges(),n.addRange(this.range)},n.prototype._getSelectionCoords=function(){var n,i,t,r,u,f,e;return t=document.selection,t!=null&&t.type!=="Control"?(n=t.createRange(),i=n.getClientRects()[0],f=[n.boundingLeft+i.width/2,n.boundingTop],r=f[0],u=f[1]):window.getSelection!=null&&(t=window.getSelection(),t.rangeCount!=null&&(n=t.getRangeAt(0).cloneRange(),n.getClientRects!=null&&(i=n.getClientRects()[0],e=[i.left+i.width/2,i.top],r=e[0],u=e[1]))),this.range=n,{x:r,y:u}},n}()